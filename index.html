<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Development and implementation of embedded low-power tracking platform - Reveal.js</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/white.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">

		<style>
.image-zoom {
	width: 100% !important;
	height: auto !important;
	max-width: none !important;
	max-height: none !important;

	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	right: 0;
}

.no-zoom {
	width: 100% !important;

	top: -15%;
	bottom: 0;
	left: 0;
	right: 0;
}

.image-zoom.dorm-inside-1 {
	width: 400% !important;

	top: -15%;
	bottom: 0;
	left: -95%;
	right: 0;
}

.image-zoom.dorm-outside-1 {
	width: 400% !important;

	top: -30%;
	bottom: 0;
	left: -140%;
	right: 0;
}

.image-zoom.dtu-inside-1 {
	width: 400% !important;

	top: -130%;
	bottom: 0;
	left: -175%;
	right: 0;
}

.image-zoom.dtu-outside-1 {
	width: 400% !important;

	top: -230%;
	bottom: 0;
	left: -140%;
	right: 0;
}

.image-zoom.high-density-apartments-1 {
	width: 400% !important;

	top: -175%;
	bottom: 0;
	left: -100%;
	right: 0;
}

.image-zoom.low-density-apartments-1 {
	width: 400% !important;

	top: -100%;
	bottom: 0;
	left: 0;
	right: 0;
}

.image-zoom.dorm-inside-2 {
	width: 200% !important;

	top: -15%;
	bottom: 0;
	left: -25%;
	right: 0;
}

.image-zoom.dorm-outside-2 {
	width: 200% !important;

	top: -15%;
	bottom: 0;
	left: -50%;
	right: 0;
}

.image-zoom.dtu-inside-2 {
	width: 200% !important;

	top: -50%;
	bottom: 0;
	left: -65%;
	right: 0;
}

.image-zoom.dtu-outside-2 {
	width: 200% !important;

	top: -95%;
	bottom: 0;
	left: -50%;
	right: 0;
}

.image-zoom.high-density-apartments-2 {
	width: 200% !important;

	top: -70%;
	bottom: 0;
	left: -25%;
	right: 0;
}

.image-zoom.low-density-apartments-2 {
	width: 200% !important;

	top: -35%;
	bottom: 0;
	left: 0;
	right: 0;
}

.image-zoom.dorm-outside-3 {
	width: 90% !important;

	top: -15%;
	bottom: 0;
	left: 5%;
	right: -5%;
}

td {
	width: 33%;
}

.animate-zoom td {
	width: 33%;
}

.animate-zoom div {
	width: 100% !important;
	padding-bottom: 50% !important;
	overflow: hidden !important;

	position: relative;
}
		</style>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<!--- First Slide --->
				<section>
					<h2>
						Development and implementation of embedded low-power tracking platform
						<h3>Master's Defence 2025</h3>
					</h2>
					<p><nobr>Jonas Birkedal Dudal Jensen (s203849)</nobr></p>
				</section>

				<!--- Corrections --->
				<section>
					<h2>Corrections</h2>
					<p>Test</p>

					<aside class="notes">
						Before moving into the main presentation, I want to make some quick corrections.


					</aside>
				</section>

				<!--- Introduction --->
				<section>
					<h2>Introduction</h2>
					<ul>
						<li>Goal - Creating a tracking platform, not a tracker</li>
						<li class="fragment">Motivation - Why design a low power tracker?</li>
						<li class="fragment">
							Developing the tracker
							<ul>
								<li>Writing Code</li>
								<li>Creating PCB</li>
							</ul>
						</li>
						<li class="fragment">Profiling code</li>
					</ul>

					<aside class="notes">
						The goal of this project was to create a tracking device platform, which is a theoretical device other people could use in their projects.
						This includes not only a prototype, which they can use as a basis for their project, but also an analysis of its performance.
						This platform should allow for resonable tracking accuracy and it should be optimized for power consumption.

						<b>---- NEXT ----</b>
						Why do we want to create this platform?
						There are two main reasons, there is a need for trackers and tracking techniques are rarely optimized for power, but accuracy.
						This leads to an interesting analysis with a traid-off between accuracy and power, which is rarely discussed.
						This could also lead to new break-throughs in power consumption optimizations.
						For this, we would need to develop a tracker.

						<b>---- NEXT ----</b>
						The tracker consists of two parts, writing the code for it and creating the PCB.
						The order of this is important, as we might descover things about the chips when developing and profiling the code.
						This was broken in our project, and the consequences will be discussed later.

						<b>---- NEXT ----</b>
						To be able to develop power effecient code, we also need a way to profile it.
						We have therefor chosen to develop a program for this.
					</aside>
				</section>

				<!--- Requirements --->
				<section>
					<h2>Requrements</h2>
					<ul>
						<li class="fragment">Tracking accuracy: 50m</li>
						<li class="fragment">Battery-lifetime: 10 years</li>
						<li class="fragment">Communication range: 10km</li>
						<li class="fragment">Simple visulization of power consumption</li>
						<li class="fragment">Optimizations
							<ol>
								<li class="fragment">Range of communication</li>
								<li class="fragment">Power consumption</li>
								<li class="fragment">Modularity</li>
							</ol>
						</li>
					</ul>

					<aside class="notes">
						Before developing the tracker, we have to define some requirements.

						<b>---- NEXT ----</b>
						First, the accuracy of the tracker should be within 50m.
						This was chosen as within 50m you would be able to locate most devices.

						<b>---- NEXT ----</b>
						It should be able to keep running for at least 10 years on a single CR2032 battery.
						10 years were chosen, as this is the target of most LPWAN devices.

						<b>---- NEXT ----</b>
						It should be able to connect to the network from at least 10km away.
						This limits our possible communication protocols to long range communication, meaning we can expect bettery coverage without pre-setup infrastructure.

						<b>---- NEXT ----</b>
						We should be able to get at simple overview of the power consumption of the system.
						This would allow us to do more effective power consumption measurments.

						<b>---- NEXT ----</b>
						Finally we want to optimize the system on different parameters, this should be the order of importans when selecting components and creating the code.

						<b>---- NEXT ----</b>
						First is the range of the communication.

						<b>---- NEXT ----</b>
						Next is the power consumption of the system.

						<b>---- NEXT ----</b>
						Finally, the modularity of the system.

						This order was chosen as we wanted a system we can use in many different situations, for a long time, and which is extendable.
					</aside>
				</section>

				<!--- Picking Components --->
				<section>
					<h2>Picking Components</h2>
					<h3>MCU</h3>
					<ul>
						<li>STM32</li>
					</ul>
				</section>

				<!--- Program Implementation --->
				<section data-auto-animate data-auto-animate-id="1">
					<h2>Program Implementation</h2>
					<ul>
						<li>Program parts
							<ol>
								<li>Initialization</li>
								<li>Join network</li>
								<li>Scan location</li>
								<li>Send data</li>
								<li>Exit</li>
							</ol>
						</li>
						<li class="fragment">Program flow using #define</li>
					</ul>

					<aside class="notes">
						The program consists of 5 main parts: Initialization, Join network, Scanning location, Send data, and exit.

						<b>---- NEXT ----</b>
						Each part of the code does a specific task.
						This task will change based on what we want to program to do.
						To do this we use defines to mask out specific parts of the code at compile time.
						This allows for more effecient execution compared to using normal if-statements, as masking out the code will not create any aditional code.
					</aside>
				</section>
				<section data-auto-animate data-auto-animate-id="1">
					<h2>Program Implementation</h2>
					<h3>Initialization</h3>
					<div style="width: 50%; float: left;">
						<ol>
							<li>Reset LR1110</li>
							<li>Resume LR1110 communication</li>
							<li>Initialize BC660K-GL</li>
							<li>Connect to NB</li>
							<li>Initialize LR1110</li>
						</ol>
					</div>
					<div style="width: 50%; float: left">
						<img src="images/tracker-flowchart-init.svg" width="40%">
					</div>

					<aside class="notes">
						Initialization handles setting up the LR1110 and BC660K-GL.
						Based on the settings, this includes resetting the LR1110, resuming its radio communication, connecting the BC660K-GL to NB, and initializing the LR1110.
					</aside>
				</section>
				<section data-auto-animate data-auto-animate-id="1">
					<h2>Program Implementation</h2>
					<h3>Join Network</h3>
					<div style="width: 50%; float: left;">
						<ul>
							<li>Join LoRa</li>
							<li>Connect MQTT</li>
						</ul>
					</div>
					<div style="width: 50%; float: left">
						<img src="images/tracker-flowchart-join.svg" width="100%">
					</div>

					<aside class="notes">
						Joining the network is split into two paths: Joining LoRa or connecting to MQTT.
						The LoRa part does not guarentee that we are connected, this is checked later on.
						This allows us to initiate the scanning without having to wait for a response.
					</aside>
				</section>
				<section data-auto-animate data-auto-animate-id="1">
					<h2>Program Implementation</h2>
					<h3>Scan Location</h3>
					<div style="width: 50%; float: left;">
						<ol>
							<li>Scan WiFi</li>
							<li>Scan GNSS</li>
							<li>Wait for WiFi</li>
							<li>Wait for GNSS</li>
							<li>Is data valid?
								<ul>
									<li>No: Scan again and wait for result</li>
									<li>Yes: Continue</li>
								</ul>
							</li>
						</ol>
					</div>
					<div style="width: 50%; float: left">
						<img src="images/tracker-flowchart-location.svg" width="100%">
					</div>

					<aside class="notes">
						Location scanning can be done with WiFi or GNSS.
						First we initiate the scanning, then we wait for a response.
						The GNSS scanning might return that there are no sateliets, if this happens, we scan and wait again.

						This is not split into two paths, as we allow both WiFi and GNSS scanning.
					</aside>
				</section>
				<section data-auto-animate data-auto-animate-id="1">
					<h2>Program Implementation</h2>
					<h3>Send Data - LoRa</h3>
					<div style="width: 50%; float: left;">
						<ol>
							<li>Wait for connection</li>
							<li>Try to send data</li>
							<li>If data transmission failed, rejoin network</li>
						</ol>
					</div>
					<div style="width: 50%; float: left">
						<img src="images/tracker-flowchart-send-lora.svg" width="100%">
					</div>

					<aside class="notes">
						We then send the scanned data.
						This is done over LoRa or NB.
						
						For LoRa we first check if we have joined the network, if it failed, we try again until we succeed.
						We then try to send the data, first we check how many times we have failed at sending the data, if this is greater than our counter, we leave the network and rejoin.
						We then send the WiFi or GNSS data.
						If we failed, then we try again from the beginning, otherwise we continue.

						This loop is created to harden the code, as we noticed when testing the system, it might sometimes be unable to send the data, at which point re-joining the network helped.
					</aside>
				</section>
				<section data-auto-animate data-auto-animate-id="1">
					<h2>Program Implementation</h2>
					<h3>Send Data - MQTT</h3>
					<div style="width: 50%; float: left;">
						<ol>
							<li>Send WiFi data</li>
							<li>Send GNSS data</li>
						</ol>
					</div>
					<div style="width: 50%; float: left">
						<img src="images/tracker-flowchart-send-mqtt.svg" width="60%">
					</div>

					<aside class="notes">
						Sending the data over NB is simply done by publishing the results to MQTT.
						All error hanlding is done in the send function, because of how the we communicate with the BC660K-GL.
					</aside>
				</section>
				<section data-auto-animate data-auto-animate-id="1">
					<h2>Program Implementation</h2>
					<h3>Exit</h3>
					<div style="width: 50%; float: left;">
						<ol>
							<li>Leave LoRa</li>
							<li>Suspend LR1110 communication</li>
						</ol>
					</div>
					<div style="width: 50%; float: left">
						<img src="images/tracker-flowchart-end.svg" width="60%">
					</div>

					<aside class="notes">
						The final part of the code exits the LoRa network and suspends the modem right before we sleep.
					</aside>
				</section>
				<section data-auto-animate data-auto-animate-id="1">
					<h2>Program Implementation</h2>
					<h3>Sleep</h3>
					<ul>
						<li>Different sleep modes used different places:
							<ol>
								<li class="fragment">Waiting for LR1110 communication</li>
								<li class="fragment">Sleeping at the end after execution is done</li>
							</ol>
						</li>
					</ul>

					<aside class="notes">
						There are two part of the code where we sleep, at the end and when waiting for the LR1110 to communicate.

						<b>---- NEXT ----</b>
						Waiting for the LR1110 should keep the prgram counter valied, which means we have to retain RAM and registers.
						Because of this, we can only enter XXX sleep.

						<b>---- NEXT ----</b>
						The final sleep should consume the least amount of power, therefor XXX sleep mode is used.
						This also has the effect of clearing RAM and resetting the program, thus we do not have to free any pointers or create an infinite while loop.
					</aside>
				</section>

				<!--- Profiling Code --->
				<section>
					<h2>Profiling Code</h2>
					<p>Test</p>
				</section>

				<!--- Results --->
				<section>
					<h2>Results</h2>
					<p>Test</p>
				</section>
				<section data-auto-animate data-auto-animate-id="1">
					<h2>
						Results - Accuracy of Tracking
					</h2>
					<div class="r-stretch">
						<table style="width: 100%" class="animate-zoom">
							<tr>
								<th>Dorm Inside</th>
								<th>Dorm Outside</th>
								<th>DTU Inside</th>
							</tr>
							<tr>
								<td>
									<div>
										<img src="/images/dorm-inside-gt.png" class="image-zoom dorm-inside-1">
									</div>
								</td>
								<td>
									<div>
										<img src="/images/dorm-outside-gt.png" class="image-zoom dorm-outside-1">
									</div>
								</td>
								<td>
									<div>
										<img src="/images/dtu-gt.png" class="image-zoom dtu-inside-1">
									</div>
								</td>
							</tr>
						</table>
						<table style="width: 100%" class="animate-zoom">
							<tr>
								<th>DTU Outside</th>
								<th>High Density Apartments</th>
								<th>Low Density Apartments</th>
							</tr>
							<tr>
								<td>
									<div>
										<img src="/images/dtu-outside-gt.png" class="image-zoom dtu-outside-1">
									</div>
								</td>
								<td>
									<div>
										<img src="/images/high-density-appartments-gt.png" class="image-zoom high-density-apartments-1">
									</div>
								</td>
								<td>
									<div>
										<img src="/images/low-density-appartments-gt.png" class="image-zoom low-density-apartments-1">
									</div>
								</td>
							</tr>
						</table>
					</div>
				</section>
				<section data-auto-animate data-auto-animate-id="1">
					<h2>
						Results - Accuracy of Tracking
					</h2>
					<div class="r-stack">
						<div class="r-stretch">
							<table style="width: 100%" class="animate-zoom">
								<tr>
									<th>Dorm Inside</th>
									<th>Dorm Outside</th>
									<th>DTU Inside</th>
								</tr>
								<tr>
									<td>
										<div>
											<img src="/images/dorm-inside-gt.png" class="image-zoom dorm-inside-2">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/dorm-outside-gt.png" class="image-zoom dorm-outside-2">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/dtu-gt.png" class="image-zoom dtu-inside-2">
										</div>
									</td>
								</tr>
							</table>
							<table style="width: 100%" class="animate-zoom">
								<tr>
									<th>DTU Outside</th>
									<th>High Density Apartments</th>
									<th>Low Density Apartments</th>
								</tr>
								<tr>
									<td>
										<div>
											<img src="/images/dtu-outside-gt.png" class="image-zoom dtu-outside-2">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/high-density-appartments-gt.png" class="image-zoom high-density-apartments-2">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/low-density-appartments-gt.png" class="image-zoom low-density-apartments-2">
										</div>
									</td>
								</tr>
							</table>
						</div>
						<div class="r-stretch fragment">
							<table style="width: 100%" class="animate-zoom">
								<tr>
									<th>Dorm Inside</th>
									<th>Dorm Outside</th>
									<th>DTU Inside</th>
								</tr>
								<tr>
									<td>
										<div>
											<img src="/images/dorm-inside-gps.png" class="image-zoom dorm-inside-2">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/dorm-outside-gps.png" class="image-zoom dorm-outside-2">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/dtu-gps.png" class="image-zoom dtu-inside-2">
										</div>
									</td>
								</tr>
							</table>
							<table style="width: 100%" class="animate-zoom">
								<tr>
									<th>DTU Outside</th>
									<th>High Density Apartments</th>
									<th>Low Density Apartments</th>
								</tr>
								<tr>
									<td>
										<div>
											<img src="/images/dtu-outside-gps.png" class="image-zoom dtu-outside-2">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/high-density-appartments-gps.png" class="image-zoom high-density-apartments-2">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/low-density-appartments-gps.png" class="image-zoom low-density-apartments-2">
										</div>
									</td>
								</tr>
							</table>
						</div>
					</div>
				</section>
				<section data-auto-animate data-auto-animate-id="1">
					<h2>
						Results - Accuracy of Tracking
					</h2>
					<div class="r-stack">
						<div class="r-stretch">
							<table style="width: 100%" class="animate-zoom">
								<tr>
									<th>Dorm Inside</th>
									<th>Dorm Outside</th>
									<th>DTU Inside</th>
								</tr>
								<tr>
									<td>
										<div>
											<img src="/images/dorm-inside-gps.png" class="image-zoom no-zoom">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/dorm-outside-gps.png" class="image-zoom dorm-outside-3">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/dtu-gps.png" class="image-zoom no-zoom">
										</div>
									</td>
								</tr>
							</table>
							<table style="width: 100%" class="animate-zoom">
								<tr>
									<th>DTU Outside</th>
									<th>High Density Apartments</th>
									<th>Low Density Apartments</th>
								</tr>
								<tr>
									<td>
										<div>
											<img src="/images/dtu-outside-gps.png" class="image-zoom no-zoom">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/high-density-appartments-gps.png" class="image-zoom no-zoom">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/low-density-appartments-gps.png" class="image-zoom no-zoom">
										</div>
									</td>
								</tr>
							</table>
						</div>
						<div class="r-stretch fragment">
							<table style="width: 100%" class="animate-zoom">
								<tr>
									<th>Dorm Inside</th>
									<th>Dorm Outside</th>
									<th>DTU Inside</th>
								</tr>
								<tr>
									<td>
										<div>
											<img src="/images/dorm-inside-wifi.png" class="image-zoom no-zoom">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/dorm-outside-wifi.png" class="image-zoom dorm-outside-3">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/dtu-wifi.png" class="image-zoom no-zoom">
										</div>
									</td>
								</tr>
							</table>
							<table style="width: 100%" class="animate-zoom">
								<tr>
									<th>DTU Outside</th>
									<th>High Density Apartments</th>
									<th>Low Density Apartments</th>
								</tr>
								<tr>
									<td>
										<div>
											<img src="/images/dtu-outside-wifi.png" class="image-zoom no-zoom">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/high-density-appartments-wifi.png" class="image-zoom no-zoom">
										</div>
									</td>
									<td>
										<div>
											<img src="/images/low-density-appartments-wifi.png" class="image-zoom no-zoom">
										</div>
									</td>
								</tr>
							</table>
						</div>
					</div>
				</section>

				<!--- Discussion --->
				<section>
					<h2>Discussion</h2>
					<p>Test</p>
					Was unable to measure accurate sleep current consumption, therefor not as accurate.
				</section>

				<!--- Conclusion --->
				<section>
					<h2>Conclusion</h2>
					<p>Test</p>
				</section>

				<!--- Further Work --->
				<section>
					<h2>Further Work</h2>
					<p>Test</p>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>
